<section class="blog-detail-section section">
  <!-- Loading State -->
  @if (loading()) {
    <app-loading-spinner message="Loading blog post..." />
  }

  <!-- Error State -->
  @if (error()) {
    <app-error-state
      [message]="error() || 'An error occurred'"
      retryText="Back to Blogs"
      (retry)="goBack()"
    />
  }

  <!-- Blog Content -->
  @if (!loading() && !error() && blog()) {
    <div class="blog-detail-container">
      <!-- Navigation Bar -->
      <div class="blog-nav">
        <button class="back-btn" (click)="goBack()">
          <i class="fas fa-arrow-left"></i>
          Back to Blogs
        </button>
        <button class="share-btn" (click)="shareBlog()">
          <i class="fas fa-share-alt"></i>
          Share
        </button>
      </div>

      <!-- Blog Header -->
      <header class="blog-header">
        <!-- Category Badge -->
        @if (blog()?.category) {
          <div class="blog-category">
            <span class="category-icon">
              <i [class]="getCategoryIcon(blog()!.category!)"></i>
            </span>
            <span class="category-name">{{
              getCategoryLabel(blog()!.category!)
            }}</span>
          </div>
        }

        <!-- Title -->
        <h1 class="blog-title">{{ blog()?.title }}</h1>

        <!-- Meta Information -->
        <div class="blog-meta">
          <div class="meta-author-group">
            <a [routerLink]="['/home']" class="author-link">
              @if (authorInfo()?.profileImage) {
                <img
                  [src]="authorInfo()!.profileImage"
                  [alt]="authorInfo()!.name || 'Author'"
                  class="author-avatar"
                />
              }
              <div class="meta-item meta-author">
                <span class="meta-text author-name">{{
                  authorInfo()?.name || "Kapil Garg"
                }}</span>
              </div>
            </a>
            <a
              href="https://www.linkedin.com/in/kappil-garg"
              target="_blank"
              rel="noopener noreferrer"
              class="linkedin-icon-link"
              aria-label="Connect with Kapil Garg on LinkedIn"
            >
              <i class="fab fa-linkedin linkedin-icon"></i>
            </a>
          </div>
          <div class="meta-items-group">
            <div class="meta-item">
              <i class="fas fa-clock meta-icon"></i>
              <span class="meta-text"
                >{{ blog()?.readingTime || 0 }} min read</span
              >
            </div>
            <span class="meta-separator">·</span>
            <div class="meta-item">
              <span class="meta-text">{{
                blog()?.publishedAt
                  ? formatDate(blog()!.publishedAt!)
                  : "Not published"
              }}</span>
            </div>
            <span class="meta-separator">·</span>
            <div class="meta-item">
              <i class="fas fa-eye meta-icon"></i>
              <span class="meta-text">{{ blog()?.viewCount || 0 }} views</span>
            </div>
          </div>
        </div>
      </header>

      <!-- Blog Content -->
      <article class="blog-content">
        <!-- Excerpt -->
        @if (blog()?.excerpt) {
          <div class="blog-excerpt">
            <p>{{ blog()?.excerpt }}</p>
          </div>
        }

        <!-- Main Content -->
        <div class="blog-body" [innerHTML]="getSanitizedContent()"></div>
      </article>

      <!-- Blog Footer -->
      <footer class="blog-footer">
        @if (blog()?.category) {
          <div class="blog-tags">
            <span class="tag">
              <span class="tag-icon">
                <i [class]="getCategoryIcon(blog()!.category!)"></i>
              </span>
              {{ getCategoryLabel(blog()!.category!) }}
            </span>
          </div>
        }

        <div class="blog-share">
          <button class="share-btn" (click)="shareBlog()">
            <i class="fas fa-share-alt"></i>
            Share this post
          </button>
        </div>
      </footer>

      <!-- Author/Connect Section -->
      <div class="blog-author-section">
        <div class="author-content">
          <h3 class="author-title">Enjoyed this post?</h3>
          <p class="author-description">
            Follow me on LinkedIn for more insights on technology, career
            growth, and software development.
          </p>
          <a
            class="libutton"
            href="https://www.linkedin.com/in/kappil-garg"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="Follow Kapil Garg on LinkedIn"
          >
            Follow on LinkedIn
          </a>
        </div>
      </div>
    </div>
  }

  <!-- Not Found State -->
  @if (!loading() && !error() && !blog()) {
    <div class="not-found-state">
      <div class="not-found-icon">
        <i class="fas fa-file-alt"></i>
      </div>
      <h3>Blog post not found</h3>
      <p>The blog post you're looking for doesn't exist or has been removed.</p>
      <button class="back-btn" (click)="goBack()">
        <i class="fas fa-arrow-left"></i>
        Back to Blogs
      </button>
    </div>
  }
</section>
